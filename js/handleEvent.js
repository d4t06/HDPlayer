import{audio,goTopBtn,musicVolume,nextBtn,playBtn,prevBtn,randomBtn,rePeatBtn,timeSlider}from"./constant.js";import{updateVolume}from"./handleAudioEvent.js";import{getLocalStorageItem,setLocalStorage}from"./utils/appHelper.js";const $$=document.querySelectorAll.bind(document);export default function handleEvent(){const t=this,o=$$(".song-item");o.forEach(((e,n)=>{e.onclick=i=>{o[t.currentIndex].contains(i.target)||t.currentSong&&e.id===t.currentSong.id||(t.currentIndex=n,t.isFirstLoadSong=!1,t.loadCurrentSong())}})),window.onscroll=function(){(window.scrollY||document.documentElement.scrollTop)>100?goTopBtn.classList.add("show"):goTopBtn.classList.remove("show")},musicVolume.onclick=function(t){let o=musicVolume.offsetWidth,e=(t.clientX-25)/o;updateVolume(+e.toFixed(2)),setLocalStorage("volume",e.toFixed(2))},musicVolume.onwheel=function(t){t.preventDefault();const o=.05;let e=audio.volume;t.deltaY>0?e-o>0?e-=o:e=0:e+o<1?e+=o:e=1,updateVolume(+e.toFixed(2)),setLocalStorage("volume",e.toFixed(2))},timeSlider.onclick=o=>{t.status="waiting";let e=timeSlider.offsetWidth,n=Math.floor((o.clientX-25)/e*100),i=audio.duration*n/100;audio.currentTime=+i.toFixed(2)},playBtn.onclick=function(){if(t.isPlaying)audio.pause();else{if(t.isFirstLoadSong){const o=getLocalStorageItem("current-time",0);audio.currentTime=o,t.isFirstLoadSong=!1}audio.play()}},nextBtn.onclick=function(){t.nextSong(),t.endOfList=!1},prevBtn.onclick=function(){t.prevSong()},randomBtn.onclick=function(){const o=!t.isRandom;t.isRandom=o,setLocalStorage("isRandom",o),randomBtn.classList.toggle("active",o)},rePeatBtn.onclick=function(){const o=!t.isRepeat;t.isRepeat=o,setLocalStorage("isRepeat",o),rePeatBtn.classList.toggle("active",o)},goTopBtn.onclick=()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0}}